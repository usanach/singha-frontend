const galleryImage = [
    { src: './../../../assets/gallery/exterior/1.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/1.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/2.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/2.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/3.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/3.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/4.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/4.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/5.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/5.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/6.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/6.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/7.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/7.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/8.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/8.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/9.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/9.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/10.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/10.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/11.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/11.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/12.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/12.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/13.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/13.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/14.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/14.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/15.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/15.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/16.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/16.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/17.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/17.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/18.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/18.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/19.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/19.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/20.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/20.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/21.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/21.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/22.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/22.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/23.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/23.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/24.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/24.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/25.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/25.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/26.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/26.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/27.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/27.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/exterior/28.jpg', thumbnail: "./../../../assets/gallery/exterior-thumbnail/28.jpg", type: 'image', category: ['Exterior'] },
    { src: './../../../assets/gallery/facilities/2.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/2.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/3.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/3.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/4.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/4.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/5.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/5.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/6.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/6.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/7.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/7.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/8.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/8.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/9.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/9.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/10.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/10.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/11.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/11.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/12.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/12.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/13.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/13.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/14.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/14.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/15.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/15.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/17.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/17.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/18.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/18.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/19.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/19.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/20.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/20.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/21.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/21.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/22.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/22.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/23.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/23.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/24.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/24.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/25.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/25.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/26.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/26.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/27.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/27.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/28.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/28.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/29.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/29.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/30.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/30.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/31.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/31.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/32.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/32.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/33.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/33.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/34.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/34.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/35.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/35.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/36.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/36.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/37.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/37.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/38.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/38.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/39.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/39.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/40.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/40.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/41.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/41.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/42.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/42.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/43.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/43.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/44.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/44.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/45.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/45.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/facilities/46.jpg', thumbnail: "./../../../assets/gallery/facilities-thumbnail/46.jpg", type: 'image', category: ['Facilities'] },
    { src: './../../../assets/gallery/interior/1Bedroom/1.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/1.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/2.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/2.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/3.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/3.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/4.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/4.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/5.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/5.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/6.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/6.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/7.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/7.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/8.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/8.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/9.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/9.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/1Bedroom/10.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/1bedroom-thumbnail/10.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/1.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/1.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/2.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/2.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/3.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/3.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/4.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/4.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/5.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/5.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/6.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/6.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/7.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/7.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/8.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/8.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/9.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/9.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/gallery/interior/2Bedroom/10.jpg', thumbnail: "./../../../assets/gallery/interior-thumbnail/2bedroom-thumbnail/10.jpg", type: 'image', category: ['Interior'] },
    { src: './../../../assets/vdo/The_Extro_Final_animation.mp4', thumbnail: './../../../assets/vdo/vdo-thumbnail/The_Extro_Final_animation-thumbnail.png' , type: 'video', category: ['Vdo'] },
    { src: './../../../assets/vdo/TheExtroFinal.mp4', thumbnail: './../../../assets/vdo/vdo-thumbnail/TheExtroFinal-thumbnail.png' , type: 'video', category: ['Vdo'] },
];

function getMediaDimensions(src, type) {
    return new Promise((resolve, reject) => {
        if (type === 'image') {
            const img = new Image();
            img.onload = () => {
                resolve({ width: img.width, height: img.height });
            };
            img.onerror = () => {
                reject(new Error(`Error loading image: ${src}`));
            };
            img.src = src;
        } else if (type === 'video') {
            const video = document.createElement('video');
            video.onloadedmetadata = () => {
                resolve({ width: video.videoWidth, height: video.videoHeight });
            };
            video.onerror = () => {
                reject(new Error(`Error loading video: ${src}`));
            };
            video.src = src;
        }
    });
}

let categorizedImages = {
    All: { verticle: [], horizontal: [] },
    Exterior: { verticle: [], horizontal: [] },
    Interior: { verticle: [], horizontal: [] },
    Facilities: { verticle: [], horizontal: [] },
    Vdo: { verticle: [], horizontal: [] }
};
let imagesCategorized = false;

async function categorizeImages() {
    if (imagesCategorized) {
        return; // Skip categorization if already done
    }

    // console.log("Starting categorization...");
    for (const image of galleryImage) {
        try {
            const { width, height } = await getMediaDimensions(image.src, image.type);
            // console.log(width, height);
            const aspectRatio = width / height;
            const orientation = aspectRatio > 1 ? 'horizontal' : 'verticle';

            // Add to "All" category
            categorizedImages.All[orientation].push(image);

            for (const category of image.category) {
                if (categorizedImages[category]) {
                    categorizedImages[category][orientation].push(image);
                }
            }
        } catch (error) {
            console.error(`Error processing image ${image.src}:`, error);
        }
    }

    imagesCategorized = true;
    initializeSwipers();
    // console.log('Categorized Images:', categorizedImages);
}

let swiperInstances = {};

function initializeSwipers() {
    const swiperOptions = {
        loop: false,
        pagination: {
            clickable: true,
        },
        navigation: {
            nextEl: '.button-next',
            prevEl: '.button-prev',
        },
        breakpoints: {
            0: {
                slidesPerView: 'auto',
            },
            768: {
                slidesPerView: 'auto',
            },
            1024: {
                slidesPerView: 1,
            },
            1366: {
                slidesPerView: 1,
            },
            1440: {
                slidesPerView: 1,
            },
            1920: {
                slidesPerView: 1,
            },
        },
    };

    swiperInstances = {
        All: new Swiper('#all-slider', {
            ...swiperOptions,
            // slidesPerView: 1,
            pagination: { el: '#all-slider .swiper-pagination' },
        }),
        Exterior: new Swiper('#exterior-slider', {
            ...swiperOptions,
            // slidesPerView: 1,
            pagination: { el: '#exterior-slider .swiper-pagination' },
        }),
        Interior: new Swiper('#interior-slider', {
            ...swiperOptions,
            // slidesPerView: 1,
            pagination: { el: '#interior-slider .swiper-pagination' },
        }),
        Facilities: new Swiper('#facilities-slider', {
            ...swiperOptions,
            // slidesPerView: 1,
            pagination: { el: '#facilities-slider .swiper-pagination' },
        }),
        Vdo: new Swiper('#vdo-slider', {
            ...swiperOptions,
            // slidesPerView: 1,
            pagination: { el: '#vdo-slider .swiper-pagination' },
        })
    };

    addImagesToSwipers();
}

function addImagesToSwipers() {
    function createSlide(content, widthClass) {
        return `<div class="swiper-slide ${widthClass}">${content}</div>`;
    }

    function getWrappersPerSlide() {
        const screenWidth = window.innerWidth;
        if (screenWidth < 560) return 1;
        if (screenWidth < 768) return 2;
        if (screenWidth < 1024) return 3;
        if (screenWidth < 1366) return 4;
        if (screenWidth < 1440) return 5;
        return 6; // Default for larger screens
    }

    for (const [category, sw] of Object.entries(swiperInstances)) {
        if (!sw) {
            console.error(`Swiper instance for ${category} is not initialized.`);
            continue;
        }

        const images = categorizedImages[category];
        let wrappers = [];
        let horizontalIndex = 0;

        function getNextHorizontalWrapper() {
            let horizontalWrapper = '';
            if (horizontalIndex < images.horizontal.length) {
                for (let i = 0; i < 2 && horizontalIndex < images.horizontal.length; i++, horizontalIndex++) {
                    if (i === 0) horizontalWrapper = '<div class="horizontal-wrapper">';
                    const media = images.horizontal[horizontalIndex];
                    if (media.type === 'image') {
                        horizontalWrapper += `
                            <a href="${media.src}" data-lightbox="image-gallery" data-title="Gallery Image">
                                <img loading="lazy" src="${media.thumbnail}" alt="Gallery Image" />
                            </a>`;
                    } else if (media.type === 'video') {
                        horizontalWrapper += `
                            <a watch href="${media.src}" data-lity class="video-wrapper">
                                <video poster="${media.thumbnail}" >
                                    <source src="${media.src}" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                                <div class="video-overay">
                                    <svg viewBox="-3 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" 
                                    xmlns:xlink="http://www.w3.org/1999/xlink" 
                                    xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" 
                                    fill="#ffffff" stroke="#ffffff">
                                    <g id="SVGRepo_bgCarrier" stroke-width="0">
                                    </g>
                                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                                    </g>
                                    <g id="SVGRepo_iconCarrier"> <title>play</title> <desc>Created with Sketch Beta.
                                    </desc> <defs> </defs> 
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> 
                                    <g id="Icon-Set-Filled" sketch:type="MSLayerGroup" transform="translate(-419.000000, -571.000000)" 
                                    fill="#ffffff"> 
                                    <path d="M440.415,583.554 L421.418,571.311 C420.291,570.704 419,570.767 419,572.946 L419,597.054 C419,
                                    599.046 420.385,599.36 421.418,598.689 L440.415,586.446 C441.197,585.647 441.197,584.353 440.415,
                                    583.554" id="play" sketch:type="MSShapeGroup"> </path> </g> </g> </g></svg>
                                </div>
                            </a>
                            `;
                    }
                }
                horizontalWrapper += '</div>';
            }
            return horizontalWrapper;
        }

        let verticleIndex = 0;
        let useverticle = true;
        while (verticleIndex < images.verticle.length || horizontalIndex < images.horizontal.length) {
            if (useverticle && verticleIndex < images.verticle.length) {
                const media = images.verticle[verticleIndex];
                let verticleWrapper = '<div class="verticle-wrapper">';
                if (media.type === 'image') {
                    verticleWrapper += `
                        <a href="${media.src}" data-lightbox="image-gallery" data-title="Gallery Image">
                            <img loading="lazy" src="${media.thumbnail}" alt="Gallery Image" />
                        </a>`;
                } else if (media.type === 'video') {
                    verticleWrapper += `
                    <a watch href="${media.src}" data-lity class="video-wrapper">
                        <video poster="${media.thumbnail}">
                            <source src="${media.src}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="video-overay">
                                    <svg viewBox="-3 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" 
                                    xmlns:xlink="http://www.w3.org/1999/xlink" 
                                    xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" 
                                    fill="#ffffff" stroke="#ffffff">
                                    <g id="SVGRepo_bgCarrier" stroke-width="0">
                                    </g>
                                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                                    </g>
                                    <g id="SVGRepo_iconCarrier"> <title>play</title> <desc>Created with Sketch Beta.
                                    </desc> <defs> </defs> 
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> 
                                    <g id="Icon-Set-Filled" sketch:type="MSLayerGroup" transform="translate(-419.000000, -571.000000)" 
                                    fill="#ffffff"> 
                                    <path d="M440.415,583.554 L421.418,571.311 C420.291,570.704 419,570.767 419,572.946 L419,597.054 C419,
                                    599.046 420.385,599.36 421.418,598.689 L440.415,586.446 C441.197,585.647 441.197,584.353 440.415,
                                    583.554" id="play" sketch:type="MSShapeGroup"> </path> </g> </g> </g></svg>
                                </div>
                    </a>
                    `;
                }
                verticleWrapper += '</div>';
                wrappers.push(verticleWrapper);
                verticleIndex++;
                useverticle = false;
            } else {
                const horizontalWrapper = getNextHorizontalWrapper();
                if (horizontalWrapper) {
                    wrappers.push(horizontalWrapper);
                }
                useverticle = true;
            }
        }
        const wrappersPerSlide = getWrappersPerSlide();
        const widthClass = `slide-width-${wrappersPerSlide}`;
        let slideContent = '';
        
        
        wrappers.forEach((wrapper, index) => {
            if (index % wrappersPerSlide === 0 && slideContent) {
                try {
                    sw.appendSlide(createSlide(slideContent, widthClass));
                } catch (error) {
                    console.error('Error appending slide to ${category} Swiper:, error');
                }
                slideContent = '';
            }
            slideContent += wrapper;
        });
        
        if (slideContent) {
            try {
                sw.appendSlide(createSlide(slideContent, widthClass));
            } catch (error) {
                console.error('Error appending slide to ${category} Swiper:, error');
            }
        }
    }
}

function setupTabClickListeners() {
    const tabs = document.querySelectorAll('.gallery-tabs .tab');
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const category = tab.getAttribute('data-tab');

            tabs.forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#gallery-container .swiper-container').forEach(container => {
                container.classList.remove('show');
                container.classList.add('hide');
            });

            tab.classList.add('active');
            const selectedSlider = document.querySelector(`#${category}-slider`);
            if (selectedSlider) {
                selectedSlider.classList.remove('hide');
                selectedSlider.classList.add('show');
            }
        });
    });
}

document.addEventListener('DOMContentLoaded', () => {
    if (imagesCategorized) {
        initializeSwipers();
        return;
    } else {
        categorizeImages().then(() => {
            setupTabClickListeners();
        });
    }

});